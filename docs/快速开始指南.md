# 运费公斤段分析系统 - 快速开始指南

## 📋 系统要求

- Node.js >= 16.0.0
- MongoDB >= 4.4（用于数据存储）
- npm 或 yarn 包管理器

## 🚀 本地开发环境搭建

### 1. 克隆仓库

```bash
git clone https://github.com/tom88115/freight-weight-analyzer.git
cd freight-weight-analyzer
```

### 2. 安装 MongoDB

#### macOS (使用 Homebrew)
```bash
brew tap mongodb/brew
brew install mongodb-community
brew services start mongodb-community
```

#### Windows
从 [MongoDB 官网](https://www.mongodb.com/try/download/community) 下载并安装

#### Linux (Ubuntu)
```bash
sudo apt-get install -y mongodb
sudo systemctl start mongodb
sudo systemctl enable mongodb
```

### 3. 后端配置与启动

```bash
# 进入后端目录
cd backend

# 安装依赖
npm install

# 创建环境配置文件
cp env.example .env

# 编辑 .env 文件（可选，默认配置已经可以使用）
# PORT=3000
# MONGODB_URI=mongodb://localhost:27017/freight-analyzer
# CORS_ORIGIN=http://localhost:5173

# 启动开发服务器
npm run dev
```

后端服务将在 http://localhost:3000 启动

### 4. 前端配置与启动

打开新的终端窗口：

```bash
# 进入前端目录
cd frontend

# 安装依赖
npm install

# 创建环境配置文件
cp env.example .env.development

# 编辑 .env.development 文件（可选）
# VITE_API_BASE_URL=http://localhost:3000

# 启动开发服务器
npm run dev
```

前端应用将在 http://localhost:5173 启动

### 5. 访问应用

在浏览器中打开 http://localhost:5173，您将看到运费分析系统的主界面。

## 📊 使用说明

### 上传数据

1. 准备 Excel 文件，确保包含以下列（列名可以是中文或英文）：
   - 重量 / weight
   - 运费 / cost
   - 日期 / date（可选）
   - 订单号 / orderNumber（可选）
   - 目的地 / destination（可选）
   - 承运商 / carrier（可选）

2. 点击上传区域或拖拽 Excel 文件到上传区域

3. 等待文件上传和处理完成

### 查看分析结果

- **统计卡片**：显示总记录数、总运费、平均运费和数据时间范围
- **图表分析**：
  - 各重量段订单数量分布（柱状图）
  - 重量段订单占比（饼图）
  - 各重量段运费统计（组合图）
- **数据表格**：查看详细的运费记录，支持排序和筛选

### 筛选数据

使用顶部的筛选工具：
- 选择日期范围
- 选择承运商
- 点击"查询"按钮应用筛选条件
- 点击"重置"按钮清除筛选

## 🔧 常见问题

### Q1: MongoDB 连接失败

**A:** 
- 确保 MongoDB 服务正在运行
- 检查 `.env` 文件中的 `MONGODB_URI` 配置是否正确
- 尝试使用 `mongosh` 命令测试连接

### Q2: 前端无法连接后端

**A:**
- 确保后端服务已启动并在 3000 端口运行
- 检查前端 `.env.development` 文件中的 `VITE_API_BASE_URL` 配置
- 检查浏览器控制台的错误信息

### Q3: Excel 文件上传失败

**A:**
- 确保文件格式为 `.xlsx` 或 `.xls`
- 文件大小不超过 10MB
- 检查 Excel 文件是否包含必需的"重量"和"运费"列
- 确保数据格式正确（重量和运费应为数字）

### Q4: 图表不显示

**A:**
- 确保已经上传数据
- 检查浏览器控制台是否有错误
- 尝试刷新页面

## 📝 Excel 文件示例

| 订单号 | 重量 | 运费 | 日期 | 目的地 | 承运商 |
|--------|------|------|------|--------|--------|
| ORD001 | 1.5  | 12.5 | 2024-10-01 | 北京 | 顺丰 |
| ORD002 | 3.2  | 18.0 | 2024-10-02 | 上海 | 韵达 |
| ORD003 | 0.8  | 8.0  | 2024-10-03 | 广州 | 圆通 |

## 🔐 数据安全

- 所有上传的数据仅存储在本地 MongoDB 数据库
- 不会上传到任何第三方服务器
- 可随时使用"清空记录"功能删除所有数据

## 💡 开发技巧

### 热重载

- 前端和后端都支持热重载
- 修改代码后会自动刷新

### 调试

- 后端：在终端查看日志输出
- 前端：使用浏览器开发者工具的 Console 和 Network 面板

### 数据库管理

推荐使用 MongoDB Compass 可视化管理工具：
```bash
brew install --cask mongodb-compass  # macOS
```

## 📚 更多资源

- [项目 GitHub 仓库](https://github.com/tom88115/freight-weight-analyzer)
- [后端 API 文档](http://localhost:3000)
- [React 文档](https://react.dev)
- [Ant Design 组件库](https://ant.design)
- [MongoDB 文档](https://docs.mongodb.com)

## 🆘 获取帮助

如果遇到问题：
1. 查看本文档的常见问题部分
2. 检查浏览器控制台和后端日志
3. 在 GitHub 仓库提交 Issue

## 🎉 开始使用

现在您已经完成了所有配置，可以开始使用运费分析系统了！

祝您使用愉快！ 📦✨

